# ISL Translation - Enhanced Training Config for Small Dataset
# With extra safety against model collapse

model:
  i3d_pretrained: "models/rgb_imagenet.pt"
  freeze_i3d: true
  
  # Increased regularization for small dataset
  lstm_hidden: 512
  lstm_layers: 2
  lstm_dropout: 0.5  # Increased from 0.3
  bidirectional: true
  
  t5_model: "t5-small"
  max_target_length: 50

training:
  batch_size: 8
  accumulation_steps: 4
  learning_rate: 5.0e-5  # Lower for stability
  weight_decay: 0.05      # Stronger L2 regularization
  epochs: 100             # More epochs since dataset is small
  early_stopping_patience: 15  # More patience
  save_every_n_epochs: 5
  
  # NEW: Label smoothing to prevent overconfidence
  label_smoothing: 0.1

stability:
  gradient_clip: 1.0
  warmup_steps: 1000     # Longer warmup
  mixed_precision: true
  nan_skip: true
  nan_patience: 20

data:
  num_frames: 30
  frame_size: 224
  train_split: 0.7
  val_split: 0.15
  test_split: 0.15
  num_workers: 8  # Server has more cores

paths:
  dataset_dir: "/media/rvcse22/CSERV/kortex_sem5/Videos_Sentence_Level_rams/"
  checkpoint_dir: "checkpoints"
  log_dir: "logs"

evaluation:
  beam_size: 4
  length_penalty: 0.6
